{% extends "base.html" %}

{% block title %}My Personas - MyBella{% endblock %}

{% block content %}
<div class="container personas-page">
    <div class="page-header">
        <div class="header-content">
            <div>
                <h1>My Personas</h1>
                <p class="text-muted">Manage your AI companions - each with their own personality, voice, and memory</p>
            </div>
            <button class="btn btn-primary" onclick="openCreatePersonaModal()">
                <span>Create Custom Persona</span>
            </button>
        </div>
    </div>

    <!-- Current Persona -->
    <div class="current-persona-section" id="currentPersonaSection">
        <div class="section-label">Currently Active</div>
        <!-- Dynamically loaded -->
    </div>

    <!-- System Personas -->
    <div class="personas-section">
        <h2 class="section-title">System Personas</h2>
        <div class="personas-grid" id="systemPersonasGrid">
            <!-- Dynamically loaded -->
        </div>
    </div>

    <!-- Custom Personas -->
    <div class="personas-section" id="customPersonasSection" style="display: none;">
        <h2 class="section-title">Your Custom Personas</h2>
        <div class="personas-grid" id="customPersonasGrid">
            <!-- Dynamically loaded -->
        </div>
    </div>
</div>

<!-- Create/Edit Persona Modal -->
<div id="personaModal" class="modal-overlay" style="display: none;">
    <div class="modal-content persona-modal">
        <div class="modal-header">
            <h2 id="modalTitle">Create Custom Persona</h2>
            <button class="modal-close" onclick="closePersonaModal()">&times;</button>
        </div>
        
        <form id="personaForm" onsubmit="savePersona(event)" enctype="multipart/form-data">
            <input type="hidden" id="personaId" name="persona_id">
            
            <div class="form-sections">
                <!-- Basic Info -->
                <div class="form-section">
                    <h3>Basic Information</h3>
                    
                    <div class="form-group">
                        <label class="form-label">Persona Name *</label>
                        <input type="text" 
                               id="personaName" 
                               name="name" 
                               class="form-input" 
                               placeholder="e.g., Luna, Dr. Smith, Coach Sam"
                               required
                               maxlength="50">
                        <small class="form-help">This is how your persona will be identified</small>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Display Name</label>
                        <input type="text" 
                               id="personaDisplayName" 
                               name="display_name" 
                               class="form-input" 
                               placeholder="Optional friendly name"
                               maxlength="100">
                    </div>

                    <div class="form-group">
                        <label class="form-label">Bio / Description</label>
                        <textarea id="personaDescription" 
                                  name="description" 
                                  class="form-textarea" 
                                  rows="3"
                                  placeholder="Describe your persona's role and purpose..."
                                  maxlength="500"></textarea>
                        <small class="form-help">Help users understand what makes this persona special</small>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Avatar Image</label>
                        <div class="avatar-upload">
                            <div class="avatar-preview" id="avatarPreview">
                                <span class="avatar-placeholder">IMG</span>
                            </div>
                            <div class="avatar-controls">
                                <input type="file" 
                                       id="avatarInput" 
                                       name="avatar" 
                                       accept="image/*" 
                                       onchange="previewAvatar(event)">
                                <label for="avatarInput" class="btn btn-secondary">Choose Image</label>
                                <small class="form-help">PNG, JPG, or GIF &bull; Max 5MB</small>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Personality -->
                <div class="form-section">
                    <h3>Personality & Style</h3>
                    
                    <div class="form-group">
                        <label class="form-label">Personality Traits</label>
                        <textarea id="personaTraits" 
                                  name="personality_traits" 
                                  class="form-textarea" 
                                  rows="3"
                                  placeholder="e.g., Empathetic, motivational, humorous, professional, creative..."
                                  maxlength="300"></textarea>
                        <small class="form-help">Comma-separated traits that define conversation style</small>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Communication Style</label>
                        <select id="communicationStyle" name="communication_style" class="form-input">
                            <option value="casual">Casual & Relaxed</option>
                            <option value="professional">Professional & Formal</option>
                            <option value="friendly" selected>Warm & Friendly</option>
                            <option value="supportive">Supportive & Caring</option>
                            <option value="motivational">Energetic & Motivational</option>
                        </select>
                    </div>
                </div>

                <!-- Voice Settings -->
                <div class="form-section">
                    <h3>Voice Customization</h3>
                    
                    <div class="form-group">
                        <label class="form-label">Voice Preset</label>
                        <select id="voicePreset" name="voice_id" class="form-input" onchange="updateVoicePreview()">
                            <option value="">Default System Voice</option>
                            <optgroup label="ElevenLabs Presets" id="elevenLabsPresets">
                                <!-- Dynamically loaded -->
                            </optgroup>
                        </select>
                        <button type="button" class="btn btn-secondary btn-sm" style="margin-top: 0.5rem;" onclick="previewVoice()">
                            Preview Voice
                        </button>
                    </div>

                    <div class="form-group">
                        <label class="form-label">Custom Voice Upload (Advanced)</label>
                        <div class="voice-upload">
                            <input type="file" 
                                   id="voiceInput" 
                                   name="voice_file" 
                                   accept="audio/*">
                            <label for="voiceInput" class="btn btn-secondary">Upload Audio Sample</label>
                            <small class="form-help">MP3, WAV, OGG &bull; Max 10MB &bull; For voice cloning</small>
                        </div>
                    </div>

                    <div class="info-box">
                        <strong>Voice Tip:</strong> Choose a preset for instant results, or upload a custom voice sample for voice cloning (requires ElevenLabs subscription).
                    </div>
                </div>
            </div>

            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" onclick="closePersonaModal()">Cancel</button>
                <button type="submit" class="btn btn-primary">
                    <span id="submitBtnText">Create Persona</span>
                </button>
            </div>
        </form>
    </div>
</div>

<!-- Delete Confirmation Modal -->
<div id="deleteModal" class="modal-overlay" style="display: none;">
    <div class="modal-content modal-small">
        <div class="modal-header">
            <h2>Delete Persona?</h2>
        </div>
        <div class="modal-body">
            <p>Are you sure you want to delete <strong id="deletePersonaName"></strong>?</p>
            <p class="text-warning">Warning: This will permanently delete all conversation history with this persona.</p>
        </div>
        <div class="modal-footer">
            <button type="button" class="btn btn-secondary" onclick="closeDeleteModal()">Cancel</button>
            <button type="button" class="btn btn-error" onclick="confirmDelete()">Delete Permanently</button>
        </div>
    </div>
</div>

<style>
:root {
    --primary: #9b59b6;
    --primary-hover: #8e44ad;
    --secondary: #3498db;
    --success: #2ecc71;
    --warning: #f39c12;
    --error: #e74c3c;
    --border-color: #e0e0e0;
    --bg-light: #f8f9fa;
}

.personas-page {
    max-width: 1200px;
    margin: 0 auto;
    padding: 2rem 1rem;
}

.page-header {
    margin-bottom: 3rem;
}

.header-content {
    display: flex;
    justify-content: space-between;
    align-items: flex-start;
    gap: 2rem;
}

.header-content h1 {
    margin: 0 0 0.5rem 0;
    font-size: 2rem;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

/* Current Persona */
.current-persona-section {
    margin-bottom: 3rem;
}

.section-label {
    font-size: 0.75rem;
    text-transform: uppercase;
    letter-spacing: 0.05em;
    color: #888;
    margin-bottom: 1rem;
    font-weight: 600;
}

.current-persona-card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    border-radius: 16px;
    padding: 2rem;
    display: flex;
    align-items: center;
    gap: 2rem;
    box-shadow: 0 8px 24px rgba(102, 126, 234, 0.3);
}

.current-persona-avatar {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    background: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 3rem;
    flex-shrink: 0;
    box-shadow: 0 4px 12px rgba(0,0,0,0.2);
}

.current-persona-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 50%;
}

.current-persona-info {
    flex: 1;
}

.current-persona-info h3 {
    margin: 0 0 0.5rem 0;
    font-size: 1.5rem;
}

.current-persona-info p {
    margin: 0;
    opacity: 0.9;
}

.current-badge {
    background: rgba(255,255,255,0.2);
    padding: 0.25rem 0.75rem;
    border-radius: 20px;
    font-size: 0.75rem;
    display: inline-block;
    margin-top: 0.5rem;
}

/* Personas Grid */
.personas-section {
    margin-bottom: 3rem;
}

.section-title {
    font-size: 1.25rem;
    margin-bottom: 1.5rem;
    color: #333;
}

.personas-grid {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 1.5rem;
}

.persona-card {
    background: white;
    border-radius: 12px;
    border: 2px solid var(--border-color);
    padding: 1.5rem;
    transition: all 0.3s ease;
    cursor: pointer;
    position: relative;
}

.persona-card:hover {
    border-color: var(--primary);
    box-shadow: 0 4px 16px rgba(155, 89, 182, 0.2);
    transform: translateY(-2px);
}

.persona-card.active {
    border-color: var(--primary);
    background: linear-gradient(135deg, rgba(155, 89, 182, 0.05), rgba(52, 152, 219, 0.05));
}

.persona-card-header {
    display: flex;
    align-items: center;
    gap: 1rem;
    margin-bottom: 1rem;
}

.persona-avatar {
    width: 60px;
    height: 60px;
    border-radius: 50%;
    background: linear-gradient(135deg, var(--primary), var(--secondary));
    color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 1.5rem;
    font-weight: bold;
    flex-shrink: 0;
}

.persona-avatar img {
    width: 100%;
    height: 100%;
    object-fit: cover;
    border-radius: 50%;
}

.persona-info {
    flex: 1;
    min-width: 0;
}

.persona-name {
    font-size: 1.1rem;
    font-weight: 600;
    margin: 0 0 0.25rem 0;
    color: #333;
}

.persona-type {
    font-size: 0.75rem;
    color: #888;
    text-transform: uppercase;
    letter-spacing: 0.05em;
}

.persona-description {
    font-size: 0.9rem;
    color: #666;
    margin-bottom: 1rem;
    line-height: 1.5;
    display: -webkit-box;
    -webkit-line-clamp: 2;
    -webkit-box-orient: vertical;
    overflow: hidden;
}

.persona-features {
    display: flex;
    gap: 0.5rem;
    flex-wrap: wrap;
    margin-bottom: 1rem;
}

.feature-tag {
    font-size: 0.75rem;
    padding: 0.25rem 0.5rem;
    background: var(--bg-light);
    border-radius: 4px;
    color: #666;
}

.persona-actions {
    display: flex;
    gap: 0.5rem;
    margin-top: 1rem;
}

.persona-actions button {
    flex: 1;
    padding: 0.5rem;
    border: none;
    border-radius: 6px;
    cursor: pointer;
    font-size: 0.85rem;
    transition: all 0.2s ease;
}

.btn-select {
    background: var(--primary);
    color: white;
}

.btn-select:hover {
    background: var(--primary-hover);
}

.btn-edit {
    background: var(--bg-light);
    color: #333;
}

.btn-edit:hover {
    background: #e0e0e0;
}

.btn-delete {
    background: var(--error);
    color: white;
}

.btn-delete:hover {
    background: #c0392b;
}

/* Modal Styles */
.modal-overlay {
    position: fixed;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    background: rgba(0,0,0,0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    z-index: 1000;
    backdrop-filter: blur(4px);
}

.modal-content {
    background: white;
    border-radius: 16px;
    max-width: 800px;
    width: 90%;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
}

.modal-small {
    max-width: 500px;
}

.modal-header {
    padding: 2rem;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.modal-header h2 {
    margin: 0;
    font-size: 1.5rem;
}

.modal-close {
    background: none;
    border: none;
    font-size: 2rem;
    cursor: pointer;
    color: #999;
    line-height: 1;
}

.modal-close:hover {
    color: #333;
}

.modal-body {
    padding: 2rem;
}

.modal-footer {
    padding: 1.5rem 2rem;
    border-top: 1px solid var(--border-color);
    display: flex;
    justify-content: flex-end;
    gap: 1rem;
}

/* Form Styles */
.form-sections {
    padding: 2rem;
    display: flex;
    flex-direction: column;
    gap: 2rem;
}

.form-section {
    padding-bottom: 2rem;
    border-bottom: 1px solid var(--border-color);
}

.form-section:last-child {
    border-bottom: none;
    padding-bottom: 0;
}

.form-section h3 {
    margin: 0 0 1.5rem 0;
    font-size: 1.1rem;
    color: var(--primary);
}

.form-group {
    margin-bottom: 1.5rem;
}

.form-label {
    display: block;
    margin-bottom: 0.5rem;
    font-weight: 500;
    color: #333;
}

.form-input,
.form-textarea {
    width: 100%;
    padding: 0.75rem;
    border: 2px solid var(--border-color);
    border-radius: 8px;
    font-size: 1rem;
    transition: border-color 0.2s ease;
}

.form-input:focus,
.form-textarea:focus {
    outline: none;
    border-color: var(--primary);
}

.form-help {
    display: block;
    margin-top: 0.25rem;
    font-size: 0.85rem;
    color: #888;
}

/* Avatar Upload */
.avatar-upload {
    display: flex;
    gap: 1.5rem;
    align-items: center;
}

.avatar-preview {
    width: 100px;
    height: 100px;
    border-radius: 50%;
    border: 2px dashed var(--border-color);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 2rem;
    background: var(--bg-light);
    overflow: hidden;
}

.avatar-preview img {
    width: 100%;
    height: 100%;
    object-fit: cover;
}

.avatar-controls input[type="file"] {
    display: none;
}

/* Info Box */
.info-box {
    background: #e3f2fd;
    border-left: 4px solid var(--secondary);
    padding: 1rem;
    border-radius: 4px;
    font-size: 0.9rem;
    color: #1976d2;
}

/* Buttons */
.btn {
    padding: 0.75rem 1.5rem;
    border: none;
    border-radius: 8px;
    cursor: pointer;
    font-size: 1rem;
    font-weight: 500;
    transition: all 0.2s ease;
}

.btn-primary {
    background: linear-gradient(135deg, var(--primary), var(--primary-hover));
    color: white;
}

.btn-primary:hover {
    transform: translateY(-2px);
    box-shadow: 0 4px 12px rgba(155, 89, 182, 0.3);
}

.btn-secondary {
    background: white;
    color: var(--primary);
    border: 2px solid var(--primary);
}

.btn-secondary:hover {
    background: var(--primary);
    color: white;
}

.btn-error {
    background: var(--error);
    color: white;
}

.btn-error:hover {
    background: #c0392b;
}

.btn-sm {
    padding: 0.5rem 1rem;
    font-size: 0.85rem;
}

.text-warning {
    color: var(--warning);
}

/* Responsive */
@media (max-width: 768px) {
    .header-content {
        flex-direction: column;
    }
    
    .personas-grid {
        grid-template-columns: 1fr;
    }
    
    .current-persona-card {
        flex-direction: column;
        text-align: center;
    }
    
    .avatar-upload {
        flex-direction: column;
    }
}
</style>

<script>
let currentEditingPersonaId = null;
let personas = [];
let voicePresets = [];

// Load all data on page load
document.addEventListener('DOMContentLoaded', function() {
    loadPersonas();
    loadVoicePresets();
});

async function loadPersonas() {
    try {
        const response = await fetch('/api/personas/available');
        if (response.ok) {
            personas = await response.json();
            renderPersonas();
        } else {
            showNotification('Failed to load personas', 'error');
        }
    } catch (error) {
        console.error('Error loading personas:', error);
        showNotification('Error loading personas', 'error');
    }
}

async function loadVoicePresets() {
    try {
        const response = await fetch('/api/personas/voice-presets');
        if (response.ok) {
            voicePresets = await response.json();
            renderVoicePresets();
        }
    } catch (error) {
        console.error('Error loading voice presets:', error);
    }
}

function renderVoicePresets() {
    const container = document.getElementById('elevenLabsPresets');
    container.innerHTML = voicePresets.map(preset => 
        `<option value="${preset.id}">${preset.name}</option>`
    ).join('');
}

function renderPersonas() {
    const current = personas.find(p => p.is_current);
    const system = personas.filter(p => !p.is_custom && !p.is_current);
    const custom = personas.filter(p => p.is_custom && !p.is_current);
    
    // Render current persona
    if (current) {
        document.getElementById('currentPersonaSection').innerHTML = `
            <div class="section-label">Currently Active</div>
            <div class="current-persona-card">
                <div class="current-persona-avatar">
                    ${current.avatar ? `<img src="/static/uploads/${current.avatar}" alt="${current.display_name}">` : current.name.charAt(0)}
                </div>
                <div class="current-persona-info">
                    <h3>${current.display_name}</h3>
                    <p>${current.description || 'Your active AI companion'}</p>
                    <span class="current-badge">Active</span>
                </div>
            </div>
        `;
    }
    
    // Render system personas
    document.getElementById('systemPersonasGrid').innerHTML = system.map(p => createPersonaCard(p)).join('');
    
    // Render custom personas
    if (custom.length > 0) {
        document.getElementById('customPersonasSection').style.display = 'block';
        document.getElementById('customPersonasGrid').innerHTML = custom.map(p => createPersonaCard(p)).join('');
    } else {
        document.getElementById('customPersonasSection').style.display = 'none';
    }
}

function createPersonaCard(persona) {
    const isCustom = persona.is_custom;
    const voiceInfo = persona.has_custom_voice ? 'Custom Voice' : (persona.voice_id ? 'Voice Enabled' : '');
    
    return `
        <div class="persona-card ${persona.is_current ? 'active' : ''}" onclick="selectPersona(${persona.id})">
            <div class="persona-card-header">
                <div class="persona-avatar">
                    ${persona.avatar ? `<img src="/static/uploads/${persona.avatar}" alt="${persona.display_name}">` : persona.name.charAt(0)}
                </div>
                <div class="persona-info">
                    <div class="persona-name">${persona.display_name}</div>
                    <div class="persona-type">${isCustom ? 'Custom' : 'System'}</div>
                </div>
            </div>
            
            <p class="persona-description">${persona.description || 'AI companion ready to chat'}</p>
            
            <div class="persona-features">
                ${persona.personality_traits ? `<span class="feature-tag">${persona.personality_traits.split(',')[0].trim()}</span>` : ''}
                ${voiceInfo ? `<span class="feature-tag">${voiceInfo}</span>` : ''}
            </div>
            
            <div class="persona-actions" onclick="event.stopPropagation()">
                ${!persona.is_current ? `<button class="btn-select" onclick="selectPersona(${persona.id})">Select</button>` : '<button class="btn-select" disabled>Active</button>'}
                ${isCustom ? `
                    <button class="btn-edit" onclick="editPersona(${persona.id})">Edit</button>
                    <button class="btn-delete" onclick="deletePersona(${persona.id}, '${persona.name}')">Delete</button>
                ` : ''}
            </div>
        </div>
    `;
}

async function selectPersona(personaId) {
    try {
        const response = await fetch('/api/personas/switch', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ persona_id: personaId })
        });
        
        if (response.ok) {
            showNotification('Persona switched successfully!', 'success');
            loadPersonas(); // Refresh
        } else {
            const error = await response.json();
            showNotification(error.error || 'Failed to switch persona', 'error');
        }
    } catch (error) {
        console.error('Error switching persona:', error);
        showNotification('Error switching persona', 'error');
    }
}

function openCreatePersonaModal() {
    currentEditingPersonaId = null;
    document.getElementById('modalTitle').textContent = 'Create Custom Persona';
    document.getElementById('submitBtnText').textContent = 'Create Persona';
    document.getElementById('personaForm').reset();
    document.getElementById('avatarPreview').innerHTML = '<span class="avatar-placeholder">IMG</span>';
    document.getElementById('personaModal').style.display = 'flex';
}

function editPersona(personaId) {
    const persona = personas.find(p => p.id === personaId);
    if (!persona) return;
    
    currentEditingPersonaId = personaId;
    document.getElementById('modalTitle').textContent = 'Edit Persona';
    document.getElementById('submitBtnText').textContent = 'Save Changes';
    
    document.getElementById('personaId').value = persona.id;
    document.getElementById('personaName').value = persona.name;
    document.getElementById('personaDisplayName').value = persona.display_name || '';
    document.getElementById('personaDescription').value = persona.description || '';
    document.getElementById('personaTraits').value = persona.personality_traits || '';
    document.getElementById('voicePreset').value = persona.voice_id || '';
    
    if (persona.avatar) {
        document.getElementById('avatarPreview').innerHTML = `<img src="/static/uploads/${persona.avatar}" alt="Avatar">`;
    }
    
    document.getElementById('personaModal').style.display = 'flex';
}

function closePersonaModal() {
    document.getElementById('personaModal').style.display = 'none';
}

async function savePersona(event) {
    event.preventDefault();
    
    const formData = new FormData(event.target);
    const isEdit = currentEditingPersonaId !== null;
    
    try {
        const url = isEdit ? `/api/personas/${currentEditingPersonaId}` : '/api/personas/create';
        const method = isEdit ? 'PUT' : 'POST';
        
        const response = await fetch(url, {
            method: method,
            body: formData
        });
        
        if (response.ok) {
            showNotification(isEdit ? 'Persona updated successfully!' : 'Persona created successfully!', 'success');
            closePersonaModal();
            loadPersonas();
        } else {
            const error = await response.json();
            showNotification(error.error || 'Failed to save persona', 'error');
        }
    } catch (error) {
        console.error('Error saving persona:', error);
        showNotification('Error saving persona', 'error');
    }
}

function deletePersona(personaId, personaName) {
    currentEditingPersonaId = personaId;
    document.getElementById('deletePersonaName').textContent = personaName;
    document.getElementById('deleteModal').style.display = 'flex';
}

function closeDeleteModal() {
    document.getElementById('deleteModal').style.display = 'none';
    currentEditingPersonaId = null;
}

async function confirmDelete() {
    try {
        const response = await fetch(`/api/personas/${currentEditingPersonaId}`, {
            method: 'DELETE'
        });
        
        if (response.ok) {
            showNotification('Persona deleted successfully', 'success');
            closeDeleteModal();
            loadPersonas();
        } else {
            const error = await response.json();
            showNotification(error.error || 'Failed to delete persona', 'error');
        }
    } catch (error) {
        console.error('Error deleting persona:', error);
        showNotification('Error deleting persona', 'error');
    }
}

function previewAvatar(event) {
    const file = event.target.files[0];
    if (file) {
        const reader = new FileReader();
        reader.onload = function(e) {
            document.getElementById('avatarPreview').innerHTML = `<img src="${e.target.result}" alt="Preview">`;
        };
        reader.readAsDataURL(file);
    }
}

function previewVoice() {
    const voiceId = document.getElementById('voicePreset').value;
    if (!voiceId) {
        showNotification('Please select a voice preset first', 'info');
        return;
    }
    
    showNotification('Voice preview feature coming soon!', 'info');
}

function showNotification(message, type = 'info') {
    // Simple notification (can be enhanced)
    const colors = {
        success: '#2ecc71',
        error: '#e74c3c',
        info: '#3498db'
    };
    
    const notification = document.createElement('div');
    notification.style.cssText = `
        position: fixed;
        top: 20px;
        right: 20px;
        background: ${colors[type]};
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 8px;
        box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        z-index: 10000;
        animation: slideIn 0.3s ease;
    `;
    notification.textContent = message;
    document.body.appendChild(notification);
    
    setTimeout(() => {
        notification.style.animation = 'slideOut 0.3s ease';
        setTimeout(() => notification.remove(), 300);
    }, 3000);
}
</script>

{% endblock %}
